#=============================================================================
#
# file :        CMakeLists.txt
#
# description : File to generate a TANGO device server using cmake.
#
# project :     Starter
#
# $Author:  $
#
# $Revision:  $
# $Date:  $
#
#=============================================================================
#                This file is generated by POGO
#        (Program Obviously used to Generate tango Object)
#=============================================================================
#
#

cmake_minimum_required (VERSION 2.8)
set(CMAKE_SKIP_RPATH true)

# MAKE_ENV is the path to find common environment to buil project
#
set(MAKE_ENV /segfs/tango/cppserver/env)
#
# Project definitions
#
project(Starter)

#
# optional compiler flags
#
set(CXXFLAGS_USER -g)


#
# Get global information
#
if(WIN32)
include(CmakeTangoWin.cmake)
add_definitions(-D_UNICODE)
add_definitions(-DUNICODE)
else(win32)
include(${MAKE_ENV}/cmake_tango.opt)
endif(WIN32)


#
# Files for Starter TANGO class
#
set(STARTER Starter)
set(STARTER_INCLUDE ${CMAKE_SOURCE_DIR})
set(STARTER_SRC ${STARTER}.cpp ${STARTER}Class.cpp ${STARTER}StateMachine.cpp CheckProcessUtil.cpp PingThread.cpp StarterUtil.cpp StartProcessThread.cpp)


#
# User additional include, link folders/libraries and source files
#
set(USER_INCL_DIR )
set(USER_LIB_DIR )
set(USER_LIBS )
set(USER_SRC_FILES )

#
# Set gloabal info and include directories
#
set(ALL_CLASS_INCLUDE  ${STARTER_INCLUDE}  ${USER_INCL_DIR})
set(SERVER_SRC ${STARTER_SRC}  ${USER_SRC_FILES} ClassFactory.cpp main.cpp)
include_directories(${ALL_CLASS_INCLUDE}  ${USER_INCL_DIR} ${TANGO_INCLUDES})
if(WIN32)
link_directories(${TANGO_LNK_DIR})
endif(WIN32)

#
# Device Server generation
#
set(SERVER_NAME Starter)
if(WIN32)
add_executable(Starter ${SERVER_SRC})
target_link_libraries(Starter PUBLIC ${TANGO_DYN_LIBS} ${WIN_LIBS} ${ZMQ_LIB_DYN})
install(TARGETS Starter 
        RUNTIME DESTINATION bin
        LIBRARY DESTINATION bin
        ARCHIVE DESTINATION bin)
add_compile_options(/MT)
add_executable(Starter_sta ${SERVER_SRC})
target_link_libraries(Starter_sta PUBLIC ${TANGO_STA_LIBS} ${WIN_LIBS} ${ZMQ_LIB_STA})
target_compile_options(Starter_sta PUBLIC MT)
install(TARGETS Starter_sta 
        RUNTIME DESTINATION bin
        LIBRARY DESTINATION bin
        ARCHIVE DESTINATION bin)
        
  set_property(TARGET Starter_sta PROPERTY COMPILE_DEFINITIONS "_WINSTATIC;")
  set_property(TARGET Starter PROPERTY COMPILE_DEFINITIONS "LOG4TANGO_HAS_DLL;TANGO_HAS_DLL;")
else(WIN32)
include(${MAKE_ENV}/cmake_common_target.opt)
endif(WIN32)

